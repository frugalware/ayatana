# Compiling Time: 0.14 SBU
# Maintainer: bouleetbil <bouleetbil@frogdev.info>

pkgname=polkit
pkgver=0.102
pkgrel=1
pkgdesc="Policy framework for controlling privileges for system-wide services"
url="http://hal.freedesktop.org/docs/PolicyKit"
depends=('pam' 'dbus-glib' 'expat' 'eggdbus')
makedepends=('intltool' 'gobject-introspection>=0.9.0' 'docbook-xsl')
groups=('apps')
archs=('i686' 'x86_64' 'ppc' 'arm')
up2date="Flasttar http://hal.freedesktop.org/releases/"
source=(http://hal.freedesktop.org/releases/$pkgname-$pkgver.tar.gz)
sha1sums=('62907e1c9ffc45a8cd5f2cec2b5eabb168551f0e')

replaces=('policykit')
conflicts=('policykit')
options=('scriptlet')

build() {
	Fbuild --with-authdb=default --with-authfw=pam --with-os-type=FrugalWare \
	--disable-selinux
	Fcp $pkgname-$pkgver/src/polkitagent/polkitagentenumtypes.h usr/include/polkit-1/polkitagent/

###
### BEGIN DESKTOP POLICY CONFIGURATION ###
###

cat > $Fdestdir/etc/polkit-1/localauthority.conf.d/60-desktop-policy.conf << EOF
# This allows users in the wheel group to authenticate as the
# administrator.
#
# DO NOT EDIT THIS FILE, it will be overwritten on update.

[Configuration]
AdminIdentities=unix-group:wheel
EOF

cat > $Fdestdir/var/lib/polkit-1/localauthority/10-vendor.d/10-desktop-policy.pkla << EOF
# Authorizations/policy for the wheel group.
#
# DO NOT EDIT THIS FILE, it will be overwritten on update.
#
# Allow users in the wheel group to do certain actions without being
# interrupted by password dialogs
#
[Wheel Group Permissions]
Identity=unix-group:wheel
Action=org.gnome.settingsdaemon.datetimemechanism.*;org.kde.kcontrol.kcmclock.save;org.freedesktop.RealtimeKit1.*;org.freedesktop.udisks.filesystem-mount-system-internal;org.freedesktop.hostname1.set-static-hostname
ResultAny=auth_admin
ResultInactive=auth_admin
ResultActive=yes
EOF

###
### END DESKTOP POLICY CONFIGURATION
###

}

# optimization OK
